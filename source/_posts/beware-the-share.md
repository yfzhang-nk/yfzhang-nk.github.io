---
title: 程序员应该知道的97件事-7 当心共享
date: 2020-07-31 17:21:57
tags: 
	- 程序员应该知道的97件事
categories:
	- 英文文章翻译
---

原文链接：{% link Beware the Share https://97-things-every-x-should-know.gitbooks.io/97-things-every-programmer-should-know/content/en/thing_07/  %}

## {% span blue, 当心共享%}

那是我在公司的第一个项目，我刚刚完成我的学位，急于证明自己，每天工作到很晚，检查已有的代码。当我做完第一个功能开发，我格外小心地把学到的所有东西落实到位，评论、日志、尽可能的抽离共享代码到库中。然后对我认为已经准备好的代码做评审时，使我意识到重用是不被赞同的。

怎么会这样呢？学校里重用被认为是高质量软件工程的缩影。我读过的文章和教科书，以及资深的软件工程师都是这样告诉我的。一切都错了吗？

原来是我漏掉了一个关键信息：

{% emp 上下文 %}

系统中两个截然不同的部分以相同的方式执行某种逻辑，并没有我们想象中的那么重要。直到我把这些库中共享代码抽离出来为止，这些部分的代码互相是不依赖的。每一部分都可以独立演化。每一部分都可以修改自己的逻辑以满足系统日益变化的业务需求。四行相似的代码是偶然的--暂时的异常、一个巧合。直到我出现。

我构建的共享代码就像把彼此的鞋带绑在了一起。这样的话，一个业务领域的步骤如果不与其他业务同步就不能被创建出来。功能独立的维护成本通常是微不足道的，但是通用库则需要多一个数量级的测试。

当我减少了系统中的代码行数，却增加了一堆的依赖。这些依赖的上下文很重要--如果已经被本地化了，那么它可能是合理的，并且有一些积极的价值。如果这些依赖关联不大，即使它们看起来很好，但也会使系统陷入更大的问题中。

这些错误是隐蔽的，因为它们的核心内容听起来像一个好主意。当应用到正确的上下文中，这些技术是有价值的。但是在错误的上下文中，它们增加的消耗比价值更大。当碰到一段已经存在的代码，不知道都是哪些不同部分在使用它，我对哪些内容该共享会更加小心。

当心共享代码。仔细检查上下文。只有这样才能继续。

By {% link Udi Dahan  https://www.linkedin.com/in/udidahan/?originalSubdomain=il %}

## {% span blue, 单词 %}
{% pullquote [class] %}
{% span green, put in place %} 到位；落实到位；正在实施
{% span green, up until %} 一直到...为止
{% span green, negligible %} adj. 微不足道的，可以忽略的
{% span green, be held in check	%} 牵制于人
{% span green, insidious %} adj. 阴险的；隐伏的；狡猾的
{% endpullquote %}

## {% span blue, 个人观点 %}
本文给人的启发就是抽取共用代码的时候要当心，有可能他们其实没有啥关系，只是代码看起来有点相似而已，作者给出了区分共享代码的关键判断点，看上下文。不过我个人觉得这是个正确的废话，判断上下文是否适合共享代码，还是会存在很大的主观性，实际情况还是会碰到扯皮的问题。
